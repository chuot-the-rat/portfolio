/* ═══════════════════════════════════════════════════
   ScrollHighlightText
   Figma-style progressive scroll highlighting
   All classes prefixed sht- (scroll-highlight-text)
   ═══════════════════════════════════════════════════ */

/* ── Container: inherits existing paragraph styles ── */
.sht-container {
    /* No typography overrides — inherits from parent */
    position: relative;
}

/* ═══════════════════════════════════════════════════
   Token — base
   ═══════════════════════════════════════════════════ */
.sht-token {
    position: relative;
    display: inline;
    transition:
        color 210ms cubic-bezier(0.22, 1, 0.36, 1),
        opacity 210ms cubic-bezier(0.22, 1, 0.36, 1),
        font-weight 210ms cubic-bezier(0.22, 1, 0.36, 1),
        letter-spacing 210ms cubic-bezier(0.22, 1, 0.36, 1);
}

/* ── Inner text span (for layout stability) ── */
.sht-token-text {
    position: relative;
    z-index: 1;
}

/* ── Underline accent ── */
.sht-token-underline {
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 1.5px;
    border-radius: 1px;
    transform-origin: left center;
    pointer-events: none;
}

/* ═══════════════════════════════════════════════════
   Stepped mode
   ═══════════════════════════════════════════════════ */

/* Inactive state */
.sht-token--stepped {
    color: var(--color-text-tertiary);
    font-weight: 400;
    letter-spacing: 0em;
}

.sht-token--stepped .sht-token-underline {
    background: transparent;
    transform: scaleX(0);
    transition:
        transform 210ms cubic-bezier(0.22, 1, 0.36, 1),
        background-color 210ms cubic-bezier(0.22, 1, 0.36, 1);
}

/* Active state */
.sht-token--stepped.sht-token--active {
    font-weight: 500;
    letter-spacing: -0.01em;
}

.sht-token--stepped.sht-token--active .sht-token-underline {
    transform: scaleX(1);
}

/* Accent variants — stepped active */
.sht-token--stepped.sht-token--active.sht-accent--auto {
    color: var(--color-text);
}
.sht-token--stepped.sht-token--active.sht-accent--auto .sht-token-underline {
    background: color-mix(in srgb, var(--color-accent) 25%, transparent);
}

.sht-token--stepped.sht-token--active.sht-accent--text {
    color: var(--color-text);
}
.sht-token--stepped.sht-token--active.sht-accent--text .sht-token-underline {
    background: color-mix(in srgb, var(--color-text) 18%, transparent);
}

.sht-token--stepped.sht-token--active.sht-accent--accent {
    color: var(--color-accent);
}
.sht-token--stepped.sht-token--active.sht-accent--accent .sht-token-underline {
    background: color-mix(in srgb, var(--color-accent) 30%, transparent);
}

/* ═══════════════════════════════════════════════════
   Smooth mode
   Uses CSS custom property --sht-reveal (0→1) driven
   by framer-motion useTransform.
   ═══════════════════════════════════════════════════ */
.sht-token--smooth {
    /* lerp from tertiary → active via --sht-reveal */
    --sht-reveal: 0;
}

/* Accent: auto */
.sht-token--smooth.sht-accent--auto {
    color: color-mix(
        in srgb,
        var(--color-text-tertiary) calc((1 - var(--sht-reveal)) * 100%),
        var(--color-text) calc(var(--sht-reveal) * 100%)
    );
}
.sht-token--smooth.sht-accent--auto .sht-token-underline {
    background: color-mix(in srgb, var(--color-accent) 25%, transparent);
}

/* Accent: text */
.sht-token--smooth.sht-accent--text {
    color: color-mix(
        in srgb,
        var(--color-text-tertiary) calc((1 - var(--sht-reveal)) * 100%),
        var(--color-text) calc(var(--sht-reveal) * 100%)
    );
}
.sht-token--smooth.sht-accent--text .sht-token-underline {
    background: color-mix(in srgb, var(--color-text) 18%, transparent);
}

/* Accent: accent */
.sht-token--smooth.sht-accent--accent {
    color: color-mix(
        in srgb,
        var(--color-text-tertiary) calc((1 - var(--sht-reveal)) * 100%),
        var(--color-accent) calc(var(--sht-reveal) * 100%)
    );
}
.sht-token--smooth.sht-accent--accent .sht-token-underline {
    background: color-mix(in srgb, var(--color-accent) 30%, transparent);
}

/* Smooth underline: scaled via framer-motion */
.sht-token--smooth .sht-token-underline {
    transform-origin: left center;
    /* scaleX driven by inline style from framer-motion */
}

/* ═══════════════════════════════════════════════════
   Accessibility — prefers-reduced-motion
   Tokens step instantly with no transition.
   ═══════════════════════════════════════════════════ */
@media (prefers-reduced-motion: reduce) {
    .sht-token,
    .sht-token--stepped,
    .sht-token--smooth,
    .sht-token--stepped .sht-token-underline {
        transition-duration: 0ms !important;
    }
}

/* ═══════════════════════════════════════════════════
   Dark mode contrast check
   The design tokens already flip in [data-theme="dark"]:
   --color-text-tertiary: #737373 → muted
   --color-text: #fafafa → active
   Contrast ratio tertiary→bg(#0a0a0a) ≈ 5.6:1 (AA pass)
   Contrast ratio text→bg(#0a0a0a) ≈ 19.3:1 (AAA pass)
   Light mode:
   tertiary(#a3a3a3)→bg(#fff) ≈ 2.7:1 (intentionally muted)
   text(#1a1a1a)→bg(#fff) ≈ 17:1 (AAA pass)
   Active tokens always meet WCAG AA.
   ═══════════════════════════════════════════════════ */
